[[Data Link Layer]]

### Spanning Tree Protocol (STP)

Определение:

Spanning Tree Protocol (STP) — это сетевой протокол, разработанный для предотвращения петель в Ethernet-сетях. Он позволяет создавать логическую топологию сети с минимальным количеством активных соединений, обеспечивая таким образом надежность и стабильность сети.

### Как это работает

1. Выбор корневого моста:
   - В сети со многими коммутаторами (сетевыми мостами) один из них выбирается как "корневой мост" (Root Bridge). Этот выбор осуществляется на основе наименьшего идентификатора моста (Bridge ID).

2. Определение кратчайших путей:
   - После выбора корневого моста каждый коммутатор определяет кратчайший путь от себя до корневого моста. Это достигается с помощью "алгоритма построения дерева" (Tree Building Algorithm).

3. Деактивация избыточных путей:
   - Все порты, которые не являются частью кратчайшего пути к корневому мосту, блокируются. Это предотвращает создание петель и тем самым защищает сеть от проблем с петлями.

4. Состояния портов:
   - Порты в STP могут находиться в различных состояниях: 
     - Действующий (Forwarding): Порт принимает и передает трафик.
     - Блокированный (Blocking): Порт не принимает и не передает трафик, предотвращая петли.
     - Ожидание (Listening): Порт прослушивает трафик, не пересылая его.
     - Изучение (Learning): Порт изучает MAC-адреса, но не пересылает трафик.

### Зачем нужен STP

- Предотвращение петель: 
   - Без STP, если в сети есть избыточные соединения, они могут привести к петлям данных, что вызовет перегрузку и сбои в работе сети.

- Надежность:
   - STP обеспечивает автоматическое восстановление маршрутов. Если основной путь к корневому мосту неожиданно выходит из строя, STP может активировать заблокированные порты, обеспечивая эффективный обход.

- Управление трафиком:
   - Протокол помогает управлять маршрутами данных в сложных сетьях, улучшая распределение трафика.

### Заключение

Spanning Tree Protocol — это важный протокол для обеспечения надежности и стабильности в Ethernet-сетях, предотвращающий проблемы, связанные с петлями, и позволяющий управлять сложными сетевыми структурами. Используя STP, администраторы сетей могут создать более эффективную и устойчивую инфраструктуру.